{% extends "base.html" %}
{% load heroicons %}

{% block title %}Add Ticket{% endblock %}

{% block sidebar %}
<nav class="flex flex-col h-full bg-gray-50 w-64 p-4">
     <div class="mb-6 rounded-lg shadow-md bg-white p-4">
        <h2 class="text-xl font-bold text-gray-800">User Portal</h2>
    </div>
    <ul class="flex-1 space-y-2">
        <li>
            <a href="{% url 'add_ticket' %}"
                   class="flex items-center gap-2 px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg {% if request.path == '/admin/dashboard/' %}bg-gray-200 font-semibold{% endif %}">
                    {% heroicon_outline "folder-plus" class="w-5 h-5" %}
                    Add Ticket
                </a>
        </li>
         <li>
            <a href="{% url 'dashboard' %}"
                   class="flex items-center gap-2 px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg {% if request.path == '/dashboard/' %}bg-gray-200 font-semibold{% endif %}">
                    {% heroicon_outline "ticket" class="w-5 h-5" %}
                    My Tickets
                </a>
        </li>
       
    </ul>
    <div class="mt-auto">
        <a href="{% url 'logout' %}" class="flex items-center gap-2 px-3 py-2 rounded bg-gray-700 text-white hover:bg-red-600 transition">
            {% heroicon_outline "arrow-left-start-on-rectangle" %} Logout
        </a>
    </div>
</nav>
{% endblock %}

{% block content %}
<div class="container mx-auto py-8">
    <div class="max-w-4xl bg-white rounded-xl shadow-lg p-8">
        <h2 class="text-2xl font-bold mb-6 text-gray-800">Add Ticket</h2>
        <form method="post" action="{% url 'add_ticket' %}" enctype="multipart/form-data" class="grid grid-cols-1 md:grid-cols-2 gap-6">
            {% csrf_token %}

            <!-- Left Column -->
            <div class="space-y-4">
                <!-- Ticket Title -->
                <div class="relative">
                    <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">
                        {% heroicon_outline "document-text" class="w-5 h-5" %}
                    </span>
                    <input type="text" name="{{ form.ticket_title.name }}" id="{{ form.ticket_title.id_for_label }}" placeholder="Ticket Title" required
                           class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-600 focus:border-green-600"
                           {% if form.ticket_title.value %}value="{{ form.ticket_title.value }}"{% endif %} />
                </div>

                <!-- Contact Info -->
                <div class="relative">
                    <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">
                        {% heroicon_outline "envelope" class="w-5 h-5" %}
                    </span>
                    <input type="text" name="{{ form.contact_info.name }}" id="{{ form.contact_info.id_for_label }}" placeholder="Email or Phone" required
                           class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-600 focus:border-green-600"
                           {% if form.contact_info.value %}value="{{ form.contact_info.value }}"{% endif %} />
                </div>

                <!-- Problem Description -->
                <div class="relative">
                    <span class="absolute left-3 top-3 text-gray-400">
                        {% heroicon_outline "chat-bubble-left-right" class="w-5 h-5" %}
                    </span>
                    <textarea name="{{ form.problem_description.name }}" id="{{ form.problem_description.id_for_label }}" placeholder="Describe your issue..." required
                              class="w-full pl-10 pr-4 pt-3 pb-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-600 focus:border-green-600">{% if form.problem_description.value %}{{ form.problem_description.value }}{% endif %}</textarea>
                </div>
            </div>

            <!-- Right Column -->
            <div class="space-y-4">
                <!-- Priority Level -->
                <div class="relative">
                    <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">
                        {% heroicon_outline "flag" class="w-5 h-5" %}
                    </span>
                    <select name="{{ form.priority_level.name }}" id="{{ form.priority_level.id_for_label }}" required
                            class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-600 focus:border-green-600">
                        <option value="" disabled {% if not form.priority_level.value %}selected{% endif %}>Select Priority</option>
                        {% for value, label in form.priority_level.field.choices %}
                            <option value="{{ value }}" {% if form.priority_level.value == value %}selected{% endif %}>{{ label }}</option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Department -->
                <div class="relative">
                    <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">
                        {% heroicon_outline "building-office" class="w-5 h-5" %}
                    </span>
                    <select name="{{ form.department.name }}" id="{{ form.department.id_for_label }}" required
                            class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-600 focus:border-green-600">
                        <option value="" disabled {% if not form.department.value %}selected{% endif %}>Select Department</option>
                        {% for value, label in form.department.field.choices %}
                            <option value="{{ value }}" {% if form.department.value == value %}selected{% endif %}>{{ label }}</option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Preferred Contact Method -->
                <div class="relative">
                    <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">
                        {% heroicon_outline "phone" class="w-5 h-5" %}
                    </span>
                    <select name="{{ form.preferred_contact_method.name }}" id="{{ form.preferred_contact_method.id_for_label }}" required
                            class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-600 focus:border-green-600">
                        <option value="" disabled {% if not form.preferred_contact_method.value %}selected{% endif %}>Select Contact Method</option>
                        {% for value, label in form.preferred_contact_method.field.choices %}
                            <option value="{{ value }}" {% if form.preferred_contact_method.value == value %}selected{% endif %}>{{ label }}</option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Attachment -->
                <div class="relative">
                    <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">
                        {% heroicon_outline "paper-clip" class="w-5 h-5" %}
                    </span>
                    <input type="file" name="{{ form.attachment.name }}" id="{{ form.attachment.id_for_label }}"
                           class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-600 focus:border-green-600" />
                </div>
            </div>

            <!-- Submit Button Full Width -->
            <div class="md:col-span-2">
                <button type="submit" class="bg-gray-700 hover:bg-gray-700 text-white font-semibold py-3 px-6 rounded-md transition">Submit Request</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
